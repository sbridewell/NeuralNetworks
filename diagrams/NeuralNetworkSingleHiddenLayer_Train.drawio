<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2026-02-08T00:00:00.000Z" agent="GitHub Copilot" etag="1">
  <diagram name="Train Method Logic">
    <![CDATA[
    <mxGraphModel dx="850" dy="740" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Start -->
        <mxCell id="2" value="Start" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5f5e3;strokeColor=#2e7d32;" vertex="1" parent="1">
          <mxGeometry x="40" y="20" width="120" height="40" as="geometry"/>
        </mxCell>

        <!-- InitialiseWeights -->
        <mxCell id="3" value="InitialiseWeights()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f0fe;strokeColor=#1a73e8;" vertex="1" parent="1">
          <mxGeometry x="40" y="90" width="180" height="40" as="geometry"/>
        </mxCell>

        <!-- Task.Run -->
        <mxCell id="4" value="Task.Run (background)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3cd;strokeColor=#f59f00;" vertex="1" parent="1">
          <mxGeometry x="40" y="160" width="200" height="40" as="geometry"/>
        </mxCell>

        <!-- Iteration decision -->
        <mxCell id="5" value="for CurrentIteration = 0 ; &lt; NumberOfIterations ; ++" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fde7e9;strokeColor=#d32f2f;" vertex="1" parent="1">
          <mxGeometry x="320" y="160" width="180" height="60" as="geometry"/>
        </mxCell>

        <!-- Sample decision -->
        <mxCell id="6" value="for sample = 0 ; &lt; inputs.Length ; ++" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fde7e9;strokeColor=#d32f2f;" vertex="1" parent="1">
          <mxGeometry x="320" y="260" width="220" height="60" as="geometry"/>
        </mxCell>

        <!-- NormaliseInputs + expectedOutput -->
        <mxCell id="7" value="input = NormaliseInputs(inputs[sample])&#xa;expectedOutput = expectedOutputs[sample]" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f8f5;strokeColor=#00796b;" vertex="1" parent="1">
          <mxGeometry x="320" y="360" width="260" height="60" as="geometry"/>
        </mxCell>

        <!-- Forward propagation -->
        <mxCell id="8" value="hidden = ApplyHiddenWeightsAndBiases(input)&#xa;output = ApplyOutputWeightsAndBiases(hidden)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f5fe;strokeColor=#0288d1;" vertex="1" parent="1">
          <mxGeometry x="320" y="450" width="300" height="70" as="geometry"/>
        </mxCell>

        <!-- Calculate errors -->
        <mxCell id="9" value="outputLayerErrors = CalculateOutputLayerErrors(expectedOutput, output)&#xa;hiddenLayerErrors = CalculateHiddenLayerErrors(outputLayerErrors)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff5e6;strokeColor=#f57c00;" vertex="1" parent="1">
          <mxGeometry x="320" y="540" width="340" height="70" as="geometry"/>
        </mxCell>

        <!-- Compute MSE -->
        <mxCell id="10" value="OutputLayerMSE = avg(outputLayerErrors^2)&#xa;HiddenLayerMSE = avg(hiddenLayerErrors^2)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f3e5f5;strokeColor=#6a1b9a;" vertex="1" parent="1">
          <mxGeometry x="320" y="640" width="300" height="60" as="geometry"/>
        </mxCell>

        <!-- Update weights -->
        <mxCell id="11" value="UpdateOutputLayerWeightsAndBiases(outputLayerErrors, hidden, LearningRate)&#xa;UpdateHiddenLayerWeightsAndBiases(hiddenLayerErrors, input, LearningRate)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f5e9;strokeColor=#2e7d32;" vertex="1" parent="1">
          <mxGeometry x="320" y="720" width="360" height="80" as="geometry"/>
        </mxCell>

        <!-- Sample loop back connector -->
        <mxCell id="12" value="sample++" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="680" y="760" width="80" height="20" as="geometry"/>
        </mxCell>

        <!-- Iteration loop back connector -->
        <mxCell id="13" value="iteration++" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="240" y="260" width="80" height="20" as="geometry"/>
        </mxCell>

        <!-- After loops -->
        <mxCell id="14" value="NumberOfTrainingRecords = inputs.Length" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff1f0;strokeColor=#b00020;" vertex="1" parent="1">
          <mxGeometry x="40" y="820" width="280" height="40" as="geometry"/>
        </mxCell>

        <!-- End -->
        <mxCell id="15" value="End" style="ellipse;whiteSpace=wrap;html=1;fillColor=#dfe7ff;strokeColor=#2b3a9a;" vertex="1" parent="1">
          <mxGeometry x="360" y="910" width="120" height="40" as="geometry"/>
        </mxCell>

        <!-- Connectors -->
        <mxCell id="e1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#000000;" edge="1" parent="1" source="2" target="3">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e2" style="edgeStyle=orthogonalEdgeStyle;html=1;strokeColor=#000000;" edge="1" parent="1" source="3" target="4">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e3" style="edgeStyle=orthogonalEdgeStyle;html=1;strokeColor=#000000;" edge="1" parent="1" source="4" target="5">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e4" style="edgeStyle=orthogonalEdgeStyle;html=1;strokeColor=#000000;" edge="1" parent="1" source="5" target="6"/>
        <mxCell id="e5" style="edgeStyle=orthogonalEdgeStyle;html=1;strokeColor=#000000;" edge="1" parent="1" source="6" target="7"/>
        <mxCell id="e6" style="edgeStyle=orthogonalEdgeStyle;html=1;strokeColor=#000000;" edge="1" parent="1" source="7" target="8"/>
        <mxCell id="e7" style="edgeStyle=orthogonalEdgeStyle;html=1;strokeColor=#000000;" edge="1" parent="1" source="8" target="9"/>
        <mxCell id="e8" style="edgeStyle=orthogonalEdgeStyle;html=1;strokeColor=#000000;" edge="1" parent="1" source="9" target="10"/>
        <mxCell id="e9" style="edgeStyle=orthogonalEdgeStyle;html=1;strokeColor=#000000;" edge="1" parent="1" source="10" target="11"/>
        <mxCell id="e10" style="edgeStyle=orthogonalEdgeStyle;html=1;strokeColor=#000000;" edge="1" parent="1" source="11" target="6"/>
        <mxCell id="e11" style="edgeStyle=orthogonalEdgeStyle;html=1;strokeColor=#000000;" edge="1" parent="1" source="5" target="14"/>
        <mxCell id="e12" style="edgeStyle=orthogonalEdgeStyle;html=1;strokeColor=#000000;" edge="1" parent="1" source="14" target="15"/>

        <!-- Labels clarifying loop exits -->
        <mxCell id="lab_sample_exit" value="sample &lt; inputs.Length? (Yes → body; No → iteration++)" style="text;html=1;align=left;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="560" y="320" width="220" height="40" as="geometry"/>
        </mxCell>

        <mxCell id="lab_iteration_exit" value="CurrentIteration &lt; NumberOfIterations? (Yes → sample loop; No → finish)" style="text;html=1;align=left;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="40" y="230" width="260" height="40" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
    ]]>
  </diagram>
</mxfile>